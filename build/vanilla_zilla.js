!(()=>{const name="\uD83E\uDD96 Vanilla-Zilla",v=`0.0.3`,vPrefix="v-",context=!!window&&window,document=!!context&&context.document;if(!document)return void console.error("Invalid environment!");const attr_vuid="data-vuid",channel_zilla="__zilla",message_type_internal="internal",message_target_pages="pages",message_target_routing="routing",on_before_create="onBeforeCreate",on_after_create="onAfterCreate",on_ready="onReady",on_data_received="onDataReceived",on_show="onShow",on_hide="onHide",op=Object.prototype,ostring=op.toString,hasOwn=op.hasOwnProperty,isBrowser="undefined"!=typeof context&&"undefined"!=typeof navigator&&document,isWebWorker=!isBrowser&&"undefined"!=typeof importScripts,hasProp=function(e,n){return hasOwn.call(e,n)},getOwn=function(e,n){return hasProp(e,n)&&e[n]},getDeep=function(e,n){if(!e||!n)return;let t=e;return each(n.split("."),function(e){return!hasProp(t,e)||void(t=t[e])}),t},eachProp=function(e,n){if(e)for(let t in e)if(hasProp(e,t)&&n(t,e[t]))break},isArray=function(e){return"[object Array]"===ostring.call(e)},isFunction=function(e){return!!e&&"[object Function]"===ostring.call(e)},isAsyncFunction=function(e){return!!e&&"[object AsyncFunction]"===ostring.call(e)},isString=function(e){return"string"==typeof e},isObject=function(e){return!isArray(e)&&"object"==typeof e},isNumber=function(e){return!isNaN(parseFloat(e))&&isFinite(e)},isHTMLElement=function(e){return!!e&&e instanceof HTMLElement},isPromise=function(e){return!!e&&e instanceof Promise},isVanilla=function(e){return!!e&&e instanceof Vanilla},isComponent=function(e){return!!e&&e instanceof vanilla.BaseComponent},isMessage=function(e){return!!e&&e instanceof ZMessage},isView=function(e){return!!e&&e instanceof vanilla.BaseView},isHTML=function(e){return isString(e)&&/<\/?[a-z][\s\S]*>/i.test(e)},isUrl=function(e){return isString(e)&&(e.startsWith("./")||e.startsWith("http"))},isVUID=function(e){return!!e&&isString(e)&&e.startsWith(vPrefix)},toVUID=function(e,n){return isString(n)?isVUID(n)?n:e+"-"+n:n},urlHref=function(n){try{return new URL(n).href}catch(t){return new URL(n,document.baseURI).href}},each=function(e,n){if(!!e)for(let t=0;t<e.length&&!(e[t]&&n(e[t],t,e));t+=1);},eachReverse=function(e,n){if(!!e)for(let t=e.length-1;-1<t&&!(e[t]&&n(e[t],t,e));t-=1);},bind=function(e,n,...t){return!!isFunction(n)&&function(){return n.call(e,...t)}},invoke=function(e,n,...t){return!!(!!n&&(isFunction(n)||isAsyncFunction(n)))&&n.call(e,...t)},invokeAsync=function(e,n,...t){setTimeout((e,n,...t)=>{invoke(e,n,...t)},0,e,n,...t)},uuid=function(e){return e=e||"",e+"10000000-1000-4000-8000-100000000000".replace(/[018]/g,e=>(+e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>+e/4).toString(16))},vuid=function(){return uuid(vPrefix)},slugify=function(e){return e+="",e=e.replace(/^\s+|\s+$/g,""),e=e.toLowerCase(),e=e.replace(/[^a-z0-9 -]/g,"").replace(/\s+/g,"_").replace(/-+/g,"_"),e},argsSolve=function(...e){const n={comp:null,elem:null,obj:null,str:"",promise:null,func:[],args:[]};return each(e,(e,t)=>isPromise(e)?(n.promise=n.promise||[],void n.promise.push(e)):isFunction(e)?(n.func=n.func||[],void n.func.push(e)):isHTMLElement(e)?void(n.elem=e):isVanilla(e)?void(n.comp=e):isObject(e)?void(n.obj?eachProp(e,(e,t)=>{n.obj[e]=t}):n.obj=e):isArray(e)?void n.args.push(...e):void(isString(e)&&(0===t?n.str=e:n.elem?n.str=e:n.elem=e))),n},argsSolveMultiple=function(...e){const n={promises:null,functions:null,elements:null,views:null,components:null,objects:null,arrays:null,numbers:null,strings_url:null,strings_vuid:null,strings_html:null,strings:null};return each(e,e=>isPromise(e)?(n.promises=n.promises||[],void n.promises.push(e)):isFunction(e)?(n.functions=n.functions||[],void n.functions.push(e)):isHTMLElement(e)?(n.elements=n.elements||[],void(n.elements=e)):isView(e)?(n.views=n.views||[],void(n.views=e)):isVanilla(e)?(n.components=n.components||[],void(n.components=e)):isObject(e)?(n.objects=n.objects||[],void(n.objects=e)):isArray(e)?(n.arrays=n.arrays||[],void n.arrays.push(e)):isNumber(e)?(n.numbers=n.numbers||[],void n.numbers.push(e)):isUrl(e)?(n.strings_url=n.strings_url||[],void n.strings_url.push(e)):isVUID(e)?(n.strings_vuid=n.strings_vuid||[],void n.strings_vuid.push(e)):isHTML(e)?(n.strings_html=n.strings_html||[],void n.strings_html.push(e)):void(isString(e)&&(n.strings=n.strings||[],n.strings.push(e)))),n},setFunctionName=function(e,n){return isFunction(e)&&Object.defineProperty(e,"name",{value:n,writable:!1}),n};class Vanilla{constructor(){this._uid=vuid()}}class Futures{constructor(){this._late_actions=[]}push(e,n,...t){!n||this._late_actions.push(n.bind(e||this,...t))}doAll(){!this._late_actions||(each(this._late_actions,e=>{try{e()}catch(e){console.error("",e)}}),this._late_actions=[])}}class ZMessage{constructor(e,n,t,r){this._sender=e||"",this._type=n||message_type_internal,this._target=t||"*",this._data=r||{}}get sender(){return this._sender}set sender(e){this._sender=e}get type(){return this._type}set type(e){this._type=e}get target(){return this._target}set target(e){this._target=e}get data(){return this._data}set data(e){this._data=e}isTarget(e){return this._target||"*"===this._target||this._target===e}}const vanilla={};return function(e){e.__ready__=!1,e.version=v,e.env={name:name,version:v,isBrowser:isBrowser,isWorker:isWebWorker}}(vanilla),function(e){function n(e,n,t){invoke(e,n,t)}function t(e){if(isHTMLElement(e))return e;if(isHTML(e))return a(e);const{elem:n,str:t,comp:r}=argsSolve(e);return n||i(r?r.uid:t)}function r(e,n){if(!!e&&!!n){if(isHTMLElement(e))return e.getAttribute("id")||e.setAttribute("id",n),e.setAttribute(attr_vuid,n),e;if(isHTML(e))return r(a(e),n);console.error(`dom.setId() -> Element not supported: "${e}"`)}return null}function i(e){try{if(isString(e)){let n=document.getElementById(e);if(!n){const t=document.querySelectorAll(`[${attr_vuid}="${e}"]`);0<t.length&&(n=t.item(0))}if(!!n)return n;console.error(`dom.get() -> Element not found: "${e}"`)}}catch(n){console.error(`dom.get() -> Error retrieving "${e}":`,n)}return e}function a(e){const n=document.createElement("div");if(n.innerHTML=e.trim(),1<n.childElementCount){for(const e of n.children)"script"===e.tagName.toLowerCase()&&e.remove();return n}return n.firstElementChild}function d(e){if(!!e){const n=document.getElementsByTagName(e);return!!n&&0<n.length?n[0]:null}return null}function s(n,r){const i=t(n);if(!!i&&isFunction(r)){if(invoke(e,r,i))return;for(const e of i.children)s(e,r)}}function o(){return document.head||d("head")}let _=!1;e.dom={ready:function i(t,r){if(isFunction(t)){function i(){_=!0,n(e,t,e)}if(!!_)return void n(e,t,e);"complete"===document.readyState?(_=!0,n(e,t,e)):"interactive"===document.readyState?!!r&&(_=!0,n(e,t,e)):(context.addEventListener("DOMContentLoaded",()=>{!r||(context.removeEventListener("load",i),_=!0,n(e,t,e))}),context.addEventListener("load",i))}},scripts:function e(){return document.getElementsByTagName("script")||[]}(),elem:t,get:i,setId:r,remove:function n(e){try{const n=i(e);if(!!n)return n.remove(),n}catch(n){console.error(`removeElemById() -> removing element "${e}":`,n)}return null},removeChild:function n(e){try{const n=i(e);if(!!n)return n.innerHTML="",n}catch(n){console.error(`dom.removeElemChildrenById() -> removing children from "${e}":`,n)}return null},setInner:function t(e,n){try{const t=i(e);if(!!t)return t.innerHTML=n,t}catch(t){console.error(`dom.setInnerHTMLById() -> inserting "${n}" into "${e}":`,t)}return null},appendInner:function t(e,n){try{const t=i(e);if(!!t){const e=document.createElement("div");return t.append(e),e.outerHTML=n,t}}catch(n){console.error(`dom.appendElemChildById() -> adding child into "${e}":`,n)}return null},classRemove:function t(e,n){try{const t=i(e);!t||t.classList.remove(n)}catch(n){console.error(`dom.classRemove() -> adding child into "${e}":`,n)}return null},classAdd:function t(e,n){try{const t=i(e);!t||t.classList.add(n)}catch(n){console.error(`dom.classAdd() -> adding class into "${e}":`,n)}return null},tagAddStyle:function t(e,n){try{n=isString(n)?d(n):n,n=n||o();const t=document.createElement("style");n.appendChild(t),t.appendChild(document.createTextNode(e))}catch(e){console.error(`dom.tagAddStyle() -> adding style tag into header:`,e)}return null},tagAddScript:function t(e,n){try{n=isString(n)?d(n):n,n=n||o();const t=document.createElement("script");n.appendChild(t),t.appendChild(document.createTextNode(e))}catch(e){console.error(`dom.tagAddScript() -> adding script tag into header:`,e)}return null},childOfById:function r(e,n){let i=null;const a=t(e);return a?s(a,e=>{if(n===e.getAttribute("id"))return i=e,!0}):console.error("dom.childOfById()",new Error("Parent elem do not exist!")),i},each:s,head:o,body:function e(){return document.body||d("body")}}}(vanilla),function initRequire(instance){function configFn(e){return eachProp(e,function(e,n){_config[e]=n}),_config}function _fetchFn(e,n,t){if(!n)return void invoke(null,t,null,[new Error("Missing url parameter.")]);const r=isArray(n)?n:[n],i=[],a=[],d=configFn().limit;for(let s of r)s=urlHref(s),_cache_count[s]=hasProp(_cache_count,s)?_cache_count[s]+1:1,_cache_count[s]>d&&(console.warn(`Component reached the limit of ${d} requests: ${s}`),_cache_count[s]=0),!!_cache[s]&&configFn().use_cache?a.push(_cache[s]):i.push(fetch(s,{method:"GET"}));return a.length===r.length?void invoke(null,t,a):void Promise.all(i).then(async function(n){for(const t of n){const n=await t.status,r=await t.statusText,i=await t.url,d=i.split(".").pop(),s=e||_ext_fetch[d]||"text",o={url:i,ext:d,type:s};if(200!==n)o.type="error",o.error=new Error(`Error ${n} "${r}": ${i}`),a.push(o);else try{"text"===s&&(o[s]=await t.text()),"json"===s&&(o[s]=await t.json()),"blob"===s&&(o[s]=await t.blob()),"bytes"===s&&(o[s]=await t.bytes()),"arrayBuffer"===s&&(o[s]=await t.arrayBuffer()),a.push(o),_cache[i]=o}catch(n){a.push({url:i,error:n})}}invoke(instance,t,a)}).catch(function(e){a.push({error:e}),invoke(instance,t,a)})}function _solve(fetchResponses,callback){const solved=[],errors=[];for(const response of fetchResponses)if(!!response.error)errors.push(response.error);else{const ext=response.ext,type_fetch=response.type,fmt=_ext_solve[ext]||type_fetch;try{const item={type:fmt};switch(fmt){case"blob":item.value=response.blob;break;case"bytes":item.value=response.bytes;break;case"arrayBuffer":item.value=response.arrayBuffer;break;case"json":item.value=response.json;break;case"script":const text=response.text,evaluated=eval(text);evaluated?item.value=evaluated:console.warn("_solve: Missing return or export statement!",response);break;default:item.value=response.text}solved.push(item)}catch(n){errors.push(n)}}0<errors.length?invoke(instance,callback,solved,new AggregateError(errors,"Errors fetching data")):invoke(instance,callback,solved,!1)}function require(e,n,t){return new Promise((r,i)=>{e?_fetchFn(t,e,function(e){_solve(e,function(e,t){const a={};let d=0;for(const n of e)"script"===n.type?eachProp(n.value,(e,n)=>{a[e]=n}):(a[d]=n.value,d++);t?(!!n&&invoke(instance,n,a,t),i(t)):(!!n&&invoke(instance,n,a,!1),r(a))})}):i(new Error("Nothing to require, missing URLs"))})}const _cache={},_cache_count={},_ext_fetch={md:"text",js:"text",txt:"text",json:"json",jpg:"blob",png:"blob",pdf:"bytes",wav:"arrayBuffer"},_ext_solve={js:"script"},_config={use_cache:!0,limit:700};instance.require=require,instance.require.config=configFn}(vanilla),function n(e){function t(e,n,t,r){let i="";return i=e?e.uid:"",!n||(!n.id&&(n.id=uuid()),i+=i?"|"+n.id:n.id),i+=i?"|"+t:t,!r||(i+=i?"|"+r:r),i}function r(n,r,i,a,...d){const s={},o=a.bind(e,s),_=setFunctionName(o,uuid());return s.id=t(n,r,i,_),s.name=i,s.sender=n,s.target=r,s.handler=o,s.handlerName=_,s.data=[...d],s}function i(e,n,t,i,...a){const d=r(e,n,t,i,...a);return d&&d.id&&d.handler&&!o[d.id]?(o[d.id]=d,d.handler):null}function a(e,n,t){let r=0;return eachProp(o,(i,a)=>{let d=i===t||a.handlerName===t;d||(e||n?n&&a.target&&a.target.id===n.id?d=!t||a.name===t:!!e&&!!a.sender&&a.sender.uid===e.uid&&(d=!t||a.name===t):d=!t||a.name===t||a.sender.uid===t||a.target.id===t),d&&(a.target.removeEventListener(a.name,a.handler,{capture:!0}),delete o[i],r++)}),r}function d(n,t,r,a,...d){if(!!t&&!!r&&!!a){const s=e.dom.get(t);if(!!s){const e=i(n,t,r,a,...d);!e||s.addEventListener(r,e,{capture:!0})}}}function s(n,t,r){const i=isString(r)?r:isFunction(r)?r.name:r.id;return invokeAsync(e,a,n,t,i)}const o={};e.events={on:d,off:s}}(vanilla),function n(e){class t extends Vanilla{constructor(e){super(),this._model=!1,this._created=!1,this.__require(e)}async get(){return new Promise(async(e,n)=>{if(!this._model)e(null);else if(isPromise(this._model)){const n=await this._model;e(n)}else e(this._model)})}set(e){!e||(this._model?isObject(e)&&(this._model=e):this.__require(e))}__require(e){const n=this;if(!!e){if(n.__invoke_before_create(),isUrl(e))return void(n._model=new Promise(async(t,r)=>{vanilla.require(e,(e,i)=>{if(!!i)r(i);else{const i=e[0];i?(n._model=i,n._model=this.__invoke_data_received(i),n.__invoke_after_create(),t(n._model)):r(new Error("Data not found"))}}).catch()}));if(isObject(e))return n._model=this.__invoke_data_received(e),void n.__invoke_after_create();throw new Error(`Data not supported: ${e}`)}else n.__invoke_after_create()}__invoke_before_create(){invoke(this,this[on_before_create])}__invoke_after_create(){this._created||(this._created=!0,invoke(this,this[on_after_create]))}__invoke_data_received(e){const n=invoke(this,this[on_data_received],e);return isObject(n)?n:e}}e.classes={DataWrapper:t}}(vanilla),function n(e){function t(...n){const{comp:t,elem:i,str:a,obj:d}=argsSolve(...n);if(!!t)return t;const s=e.dom.elem(i||a);return new r(s,d)}class r extends Vanilla{constructor(...e){super(),this._model={},this._model.uid=this._uid,this._parent_elem=null,this._detached=!0,this._visible=!1,this._late_actions=new Futures,this._elem=null,this._elem_promise=null,this._consistence_promise_resolver=Promise.withResolvers(),this._ready_promise_resolver=Promise.withResolvers(),this._created=!1,this.__init_component(...e)}get uid(){return this._uid}get detached(){return this._detached}get visible(){return this._visible}set visible(e){e?this.show():this.hide()}set html(n){if(isHTML(n)){const t=e.html.bodyContent(n),r=this._renderHtml(t),i=e.dom.elem(r);!i||(e.dom.body().insertAdjacentElement("beforeend",i),this.setElem(i))}else if(isUrl(n)){const t=n;this._elem_promise=new Promise((n,r)=>{e.require(t,(e,i)=>{if(!!i)r(new Error(`Error creating page from "${t}": ${i}`));else{const i=e[0];isString(i)?(this.html=i,n(this._elem)):r(new Error(`Error creating page from "${t}". Unexpected returned value: ${i}`))}})})}else console.warn(`Error creating BaseComponent loading html from: "${n}"`)}setElem(e){!e||(isHTMLElement(e)?this.__init_elem(e):console.error(`BaseComponent.elem: Invalid element type: ${e}`))}async getElem(){return this._elem_promise}async ready(){return await this._ready_promise_resolver.promise}on(...n){const t=this;if(this.isConsistent()){const{promise:r,elem:i,str:a,func:d,args:s}=argsSolve(...n);if(!!r)Promise.all(r).then(e=>{for(const n of e)each(d,e=>{invoke(t,t.on,n,a,e,...s)})}).catch(e=>{console.error("BaseComponent.on#promise",e)});else{const n=i||this._elem,t=a||"click",r=d&&0<d.length&&d[0];!r||e.events.on(this,n,"\uD83E\uDD96 Vanilla-Zilla",r,...s)}}else this._late_actions.push(this,this.on,...n)}off(...n){const t=this;if(this.isConsistent()){const{promise:r,elem:i,obj:a,str:d,func:s}=argsSolve(...n);if(!!r)Promise.all(r).then(e=>{for(const n of e)each(s,e=>{invoke(t,t.off,n,d,e)})}).catch(e=>{console.error("BaseComponent.on#promise",e)});else{const n=!!s&&0<s.length?s:a||d;e.events.off(this,i,n)}}else this._late_actions.push(this,this.off,...n)}isConsistent(){return!!this._elem&&!!this._parent_elem&&!this._detached}async childElem(n){const t=toVUID(this._uid,n),r=await this.getElem();return r?e.dom.childOfById(r,t):null}attach(n){const t=this;if(!!n)try{const{promise:r,elem:i,str:a,comp:d}=argsSolve(n),s=i?i:r?r:a?e.dom.get(toVUID(this._uid,n)):d?d.getElem():n;isHTMLElement(s)?(this._parent_elem=s,this._elem&&this._parent_elem?(this._parent_elem.append(this._elem),this._detached=!1):this._late_actions.push(this,this.attach,n)):isPromise(s)?s.then(e=>{invoke(t,t.attach,e)}).catch(e=>{console.error("BaseComponent.attach#promise: ",e)}):console.warn("BaseComponent.attach() wrong parent type: ",s)}catch(e){console.error("BaseComponent.attach: ",e)}return this}show(e,...n){try{this.isConsistent()?!this._visible&&!!this._elem&&(this._elem.classList.remove("vz-hidden"),this._visible=!0,!!e&&invoke(this._elem,e,this._elem,...n),invoke(this,this[on_show])):this._late_actions.push(this,this.show,e,...n)}catch(e){console.error("BaseComponent.show: ",e)}return this}hide(e,...n){try{this.isConsistent()?this._visible&&(this._elem.classList.add("vz-hidden"),this._visible=!1,!!e&&invoke(this._elem,e,this._elem,...n),invoke(this,this[on_hide])):this._late_actions.push(this,this.hide,e,...n)}catch(e){console.error("BaseComponent.hide: ",e)}return this}fadeIn(n,t){try{this.isConsistent()?this.show(e.effects.fadeIn,n,t):this._late_actions.push(this,this.fadeIn,n,t)}catch(e){console.error("BaseComponent.fadeIn: ",e)}return this}effect(e,...n){try{this.isConsistent()?(this.show(),e.bind(this._elem,...n)):this._late_actions.push(this,this.effect,e,...n)}catch(e){console.error("BaseComponent.effect: ",e)}return this}detach(){try{this.off();const n=e.dom.body();n.append(this._elem),this._elem.classList.add("vz-hidden"),this._detached=!0,this._visible=!1}catch(e){console.error("BaseComponent.detach: ",e)}return!1}remove(){try{return this.off(),this._elem.remove(),this._elem=null,this._visible=!1,this._model=null,!0}catch(e){console.error("BaseComponent.remove: ",e)}return!1}__init_component(...e){this.__invoke_before_create();const{obj:n,str:t,elem:r}=argsSolve(...e);!n||(eachProp(n,(e,n)=>{this._model[e]=n}),!this._model.uid&&(this._model.uid=this._uid)),t?this.html=t:!!r&&(this._parent_elem=r.parentNode,!!this._parent_elem&&(this._detached=!1),r.innerHTML=this._renderHtml(r.innerHTML),r.getAttribute("id")?(this._uid=r.getAttribute("id"),!this._model.uid&&(this._model.uid=this._uid)):r.setAttribute("id",this._uid),this.setElem(r))}__init_elem(n){if(!!n)try{const t=this._uid;this._elem=n,this._elem.classList.add("vz-hidden"),e.dom.setId(this._elem,t),e.dom.each(n,n=>{if(!!n){const r=n.getAttribute("id"),i=n.tagName.toLowerCase();!r||isVUID(r)||"script"===i||"style"===i||e.dom.setId(n,toVUID(t,r))}}),!!this._parent_elem&&this._detached&&this._late_actions.doAll(),this.__invoke_after_create(),this._consistence_promise_resolver.resolve(this)}catch(e){this._consistence_promise_resolver.reject(e)}}_renderHtml(n){const t=e.template.render(n,this._model);return isHTML(t)?t:`<div>${t}</div>`}__invoke_before_create(){invoke(this,this[on_before_create])}__invoke_after_create(){const e=this;if(!e._created){e._created=!0;const n=invoke(e,e[on_after_create]);if(isPromise(n))n.catch(n=>{e._ready_promise_resolver.reject(n)}).then(n=>{const t=e.__invoke_on_ready();isPromise(t)?t.then(()=>{e._ready_promise_resolver.resolve(e)}):e._ready_promise_resolver.resolve(e)});else{const n=e.__invoke_on_ready();isPromise(n)?n.then(()=>{e._ready_promise_resolver.resolve(e)}):e._ready_promise_resolver.resolve(e)}}}__invoke_on_ready(){return invoke(this,this[on_ready])}}e.BaseComponent=r,e.components={BaseComponent:r,componentize:t}}(vanilla),function n(e){class t extends e.BaseComponent{constructor(...e){super(),this._name="anonymous",this._slug="anonymous",this._model={},this._views=new i(this),this.__init_view(...e)}get slug(){return this._slug}get name(){return this._name}set name(e){!e||(this._name=e,this._slug=slugify(e))}get model(){return this._model}get views(){return this._views}init(e,n){this.__init_view(e,n)}async ready(){return await super.ready(),await this._views.ready(),this}attach(e){if(!!e){const n=toVUID(this._uid,e);return super.attach(n)}}show(e,...n){super.show(e,...n)}hide(e,...n){super.hide(e,...n)}async childElem(e){const n=toVUID(this._uid,e);return super.childElem(n)}__init_view(...e){const{obj:n,str:t}=argsSolve(...e);!n||(eachProp(n,(e,n)=>{this._model[e]=n}),!this._model.uid&&(this._model.uid=this._uid)),!t||(super.html=t)}}class r{constructor(e,n,t,r){this._parent=r,this._name=e,this._slug=slugify(e),this._url=n,this._model=t||{},this._view_resolver=Promise.withResolvers(),this._init_loader()}get name(){return this._name}get slug(){return this._slug}get view(){return this._view_resolver.promise}_init_loader(){const n=this._url,t=this._model,r=this._name;e.require(n,(r,i)=>{i?this._view_resolver.reject(new Error(`Error creating page from "${n}": ${i}`)):eachProp(r,async(n,r)=>{const i=new r(t);if(i.name="\uD83E\uDD96 Vanilla-Zilla",i.attach(e.dom.body()),!!this._parent){const e=await this.__getElem(this._parent);i.attach(e)}this._view_resolver.resolve(i)})}).catch(e=>{console.error(`ViewLoader._init_loader() -> Error requiring page from "${n}": ${e}`)})}async __getElem(n){return isComponent(n)?await n.getElem():isPromise(n)?await n:e.dom.elem(n)}}class i{constructor(e){this._parent=e,this._view_promises=[],this._curr_view_fn=null,this._last_view_fn=null,this._curr_view=null,this._last_view=null}get parent(){return this._parent}set parent(e){this._parent=e}push(...e){for(const n of e){const e=n.name,t=n.url,i=n.data||{};if(!!e&&!!t){const n=new r(e,t,i,this._parent);this._view_promises.push(n)}}return this._view_promises.length}prepare(...e){return this.push(...e),this.__waitAll()}async ready(){return await this.__waitAll(),this}async get(e){if(isView(e))return e;const n=e instanceof r?e:null;if(!!n)return n.view;if(0<this._view_promises.length){let n=0;for(const t of this._view_promises){const r=await t.view;if(r){if(isString(e)){if(r.uid===e||r.name===e||r.slug===e)return r;}else if(isNumber(e)&&n===e)return r;n++}}}return null}async goto(e,n,...t){if(!!e){const r=await this.get(e);return await this.__activateView(r,n,...t)}}async home(){const e=await this.get(0);return await this.__activateView(e,vanilla.effects.fadeIn)}back(){return this._last_view_fn?this._last_view_fn():null}async __waitAll(){const e=[];for(const n of this._view_promises){const t=await n.view;await t.ready(),e.push(t)}return e}async __activateView(e,n,...t){if(isView(e)){for(const e of this._view_promises){const n=await e.view;n.hide()}n?e.show(n,...t):e.show(),this._last_view=this._curr_view,this._curr_view=e,this._last_view_fn=this._curr_view_fn,this._curr_view_fn=this.__activateView.bind(this,e,n,...t)}return e}}class a extends i{constructor(){super(),l.subscribe(channel_zilla,this.__onInternalMessage.bind(this))}async ready(){return super.ready()}async goto(e,n,...t){if(!!e){const r=await super.get(e),i=await super.__activateView(r,n,...t);return this.__notify(r),i}}async home(){const e=await super.get(0);if(!!e){const n=await super.__activateView(e,vanilla.effects.fadeIn);return this.__notify(e),n}return null}back(){if(!!this._last_view_fn){const e=this._last_view_fn();return this.__notify(e),e}return null}__notify(e){const n=e.slug;l.publish(channel_zilla,new ZMessage(message_target_pages,message_type_internal,message_target_routing,{name:n}))}__onInternalMessage(e,n){if(!!e&&e.channel===channel_zilla&&!!n&&n instanceof ZMessage&&n.isTarget(message_target_pages)&&!!n.data){const e=n.sender;if(e===message_target_routing){const e=n.data.hash,t=e.name||"";t?super.goto(t,null).catch(e=>{console.error(`__onInternalMessage() Navigating to page "${t}"`,e)}):this.home().catch(e=>{console.error(`__onInternalMessage() Navigating to Home page`,e)})}}}}class d extends Vanilla{constructor(){super(),this._channelName="*",this._subscription=null,this._func=null,this._args=[]}get channel(){return this._channelName}set channel(e){this._channelName=e||"*"}get subscription(){return this._subscription}set subscription(e){this._subscription=e}get func(){return this._func}bind(e,...n){isFunction(e)&&(this._func=e,this._args.push(...n))}}class s{constructor(...e){this._id="",this._channel="",!!e&&0<e.length&&(this._channel=e[0],this._id=e[1]||"",isFunction(this._id)&&(this._id=this._id.name||""))}get id(){return this._id||"*"}set id(e){this._id=e}get channel(){return this._channel||"*"}set channel(e){this._channel=e}}class o{constructor(){this._listeners=[]}publish(e,n){invokeAsync(this,(e,n)=>{e=e||"*";for(const t of this._listeners){const r=t.subscription;if("*"===r.channel||r.channel===e||"*"===e){const i=new s(e,r.id);invokeAsync(this,t.func,i,n,...t._args)}}},e,n)}subscribe(e,n,...t){e=e||"*";const r=new s;if(isFunction(n)){r.id=setFunctionName(n,uuid()),r.channel=e;const i=new d;i.subscription=r,i.channel=e,i.bind(n,...t),this._listeners.push(i)}return r}unsubscribe(...e){const n=[];if(!!e&&0<e.length){const t=e[0]instanceof s?e[0]:new s(...e),r=[...this._listeners];this._listeners=[];for(const e of r){const r=e?e.subscription:null;if(!!r){const i=r.id===t.id||"*"===t.id,a=r.channel===t.channel||"*"===t.channel,d=a&&i;d?n.push(r):this._listeners.push(e)}}}return n}clear(){this._listeners=[]}}class _ extends Vanilla{constructor(){super(),this._pages=u,this._messages=l}get pages(){return this._pages}get messages(){return this._messages}async ready(){return await this._pages.ready(),this}}const l=new o,u=new a;e.BaseView=t,e.app=new _}(vanilla),function n(e){const t=context.history,r=context.addEventListener;class i{constructor(){this._available=!0,this._enabled=!0,this._curr_hash={hash:"#",name:"",query:""},t?(r("popstate",this.__onpopstate.bind(this)),e.app.messages.subscribe(channel_zilla,this.__onInternalMessage.bind(this)),e.dom.ready(this.__onDomReady.bind(this)),console.info(`${name}: Routing enabled!`)):(this._available=!1,this._enabled=!1,console.warn(`${name}: Cannot enable routing in this environment because is not supported!`))}get enabled(){return this._enabled&&this._available}set enabled(e){this._available?this._enabled=e:e&&console.warn(`${name} Cannot enable routing in this environment because is not supported!`)}push(e){if(this.enabled&&!!context.location){const n=new URL(context.location),r=this.__parseHash(n.hash);n.hash="#"+e+(r.query?"?"+r.query:""),t.pushState({},"",n)}}replace(e){if(this.enabled&&!!context.location){const n=new URL(context.location),r=this.__parseHash(n.hash);n.hash="#"+e+(r.query?"?"+r.query:""),t.replaceState({},"",n)}}__onDomReady(){const e=new URL(context.location);this._curr_hash=this.__parseHash(e.hash),this.__notify()}__onpopstate(n){const e=this.__parseHash(n.target.location.hash),t=!!e&&e.name!==this._curr_hash.name;this._curr_hash=e,t&&this.__notify()}__parseHash(e){const n={hash:e,name:"",query:""},t=e.substring(1).toLowerCase().split("?")||[];return 0<t.length&&(n.name=t[0],2===t.length&&(n.query=t[1])),n}__notify(){const n=this._curr_hash;e.app.messages.publish(channel_zilla,new ZMessage(message_target_routing,message_type_internal,message_target_pages,{hash:n}))}__onInternalMessage(e,n){if(!!e&&e.channel===channel_zilla&&!!n&&n instanceof ZMessage&&n.isTarget(message_target_routing)&&!!n.data){const e=n.sender;if(e===message_target_pages){const e=n.data.name;this.push(e)}}}}e.routing=new i}(vanilla),function n(e){function t(n,t){const r=e.template.TPL_PREFIX,i=e.template.TPL_SUFFIX,a=e.html.encode(r),d=e.html.encode(i);let s=n;for(const e in t)if(t.hasOwnProperty(e)){const n=t[e];s=s.replaceAll(`${r+e+i}`,n),s=s.replaceAll(`${a+e+d}`,n)}return s}const r="<%",i="%>";e.template={TPL_PREFIX:"<%",TPL_SUFFIX:i,render:t}}(vanilla),function n(e){function t(){o||(o=!0,e.dom.tagAddStyle(s))}function r(n,r,i){if(!!n){t();const a=e.dom.elem(n);if(!!a){let n,t;isFunction(r)?n=r:isNumber(r)&&(t=r),isFunction(i)?n=i:isNumber(i)&&(t=i),t=t||d,a.style.animation="vanilla-fadeIn ease "+t+"ms",a.style.animationFillMode="forwards",a.style.animationIterationCount="1";const s=setInterval(function(){clearInterval(s),invoke(e,n)},t)}}}function i(n,r,i){if(!!n){t();const a=e.dom.elem(n);if(!!a){let n,t;isFunction(r)?n=r:isNumber(r)&&(t=r),isFunction(i)?n=i:isNumber(i)&&(t=i),t=t||d,a.style.animationName="vanilla-bounce",a.style.animationDuration=t+"ms",a.style.animationFillMode="both",a.style.animationIterationCount="1";const s=setInterval(function(){clearInterval(s),a.style.animationName="",invoke(e,n)},t)}}}function a(n,i,a){if(!!n){t();const d=e.dom.elem(n);!d||(d.style.opacity="0",e.dom.classRemove(d,"vz-hidden"),r(n,i,a))}}const d=1e3,s=`      
            @keyframes vanilla-fadeIn {
                0% { opacity: 0; }
                100% { opacity: 1; }
            }
            @keyframes vanilla-bounce { 
                0%, 20%, 50%, 80%, 100% {transform: translateY(0); opacity:1;} 
                40% {transform: translateY(-30px);} 
                60% {transform: translateY(-15px);} 
            }

        `;let o=!1;e.effects={fadeIn:r,bounce:i,show:a}}(vanilla),function n(e){function t(e,n,t){if(e&&"string"==typeof e){const r=new RegExp(n,"g");return e.replace(r,t)}return""}function r(e){return!!e&&0<e.toString().trim().length}function i(e,n){return 0===e.indexOf(n)}function a(e,n){return e.lastIndexOf(n||"")===e.length-(n?n.length:1)}function d(e,n,t){if(isString(e)&&isString(n)&&isString(t)&&!!n&&!!t){const r=e.indexOf(n)+n.length,i=e.lastIndexOf(t)-1;return-1<r&&-1<i?e.substring(r,i).trim():e.trim()}return e}e.strings={replaceAll:t,hasText:r,startsWith:i,endsWith:a,textBetween:d}}(vanilla),function n(e){function t(e){const n=new DOMParser().parseFromString(e,"text/html");return n.documentElement.textContent||""}function r(e){const n=document.createElement("textarea");return n.innerText=e,n.innerHTML.split("<br>").join("\n")||""}function i(n){const t=e.strings.textBetween(n,"<body>","</body>");return t||n}e.html={decode:t,encode:r,bodyContent:i}}(vanilla),function n(e){e.utils={bind:bind,invoke:invoke,invokeAsync:invokeAsync,isFunction:isFunction,isArray:isArray,isObject:isObject,isString:isString,isNumber:isNumber,isHTMLElement:isHTMLElement,isUrl:isUrl,isView:isView,isVUID:isVUID,toVUID:toVUID,each:each,eachReverse:eachReverse,eachProp:eachProp,get:getDeep,uuid:uuid,argsSolve:argsSolve,argsSolveMultiple:argsSolveMultiple}}(vanilla),function n(e){const t=`.vz-hidden {visibility: hidden; display:none;} .vz-pointer{cursor:pointer;}`;e.dom.tagAddStyle(".vz-hidden {visibility: hidden; display:none;} .vz-pointer{cursor:pointer;}")}(vanilla),vanilla.ready=function n(e){return new Promise((n,t)=>{vanilla.__ready__?(n(vanilla),invoke(vanilla,e,vanilla)):vanilla.dom.ready(()=>{vanilla.__ready__||(vanilla.__ready__=!0,context.module?console.debug(`${name} v${v}: export module inherited from.`,context.module):(context.module={exports:{}},console.debug(`${name} v${v}: using internal export module.`,context.module))),n(vanilla),invoke(vanilla,e,vanilla)})})},vanilla.ready().then(()=>{console.info(`${name} v${vanilla.version}: loaded!`)}).catch(e=>{console.error(`${name} v${v}: Error loading!`,e)}),context.vanilla=vanilla,context.vanilla})();